# 

## 脚本语言

> 大多脚本语言共性是：良好的快速开发，有效率的执行，解释而非编译执行，和其它语言编写的程序组件之间通信功能很强大。脚本通常以文本保存，只在被调用时进行解释或编译。 测试大型项目中经常把脚本和其它低级编程语言一起使用，各自发挥优势解决特定问题。脚本经常用于设计互动通信，它有许多可以单独执行的命令，可以做很高级的操作.
> 
> 这些高级命令简化了代码编写过程。诸如内存自动管理和溢出检查等性能问题可以不用考虑。在更低级或非脚本语言中，内存及变量管理和数据结构等耗费人工，为解决一个给定问题需要大量代码，当然这样能够获得更为细致的控制和优化。
> 
> 综上所述，脚本编程速度更快，且脚本文件明显小于如同类C程序文件。这种灵活性是以执行效率为代价的。脚本通常是解释执行的，速度可能很慢，且运行时更耗内存。但在一些情况下, 它所带来的编写优势就远远超过了运行时的劣势.[1]

## 比特币中的脚本系统

比特币的交易验证引擎使用两类脚本来验证比特币交易：一个**锁定脚本**和一个**解锁脚本**。

**锁定脚本**是一个放在一个输出值上的“障碍”，同时它明确了今后花费这笔输出的条件。由于锁定脚本往往含有一个公钥（即比特币地址). 

**解锁脚本**是一个满足锁定脚本在输出上条件的脚本，同时它将允许输出被消费。解锁脚本是每一笔比特币交易输出的一部分，而且往往含有一个被用户的比特币钱包（通过用户的私钥）生成的数字签名。由于解锁脚本常含有一个数字签名, 但是并非所有的解锁脚本都会包含签名。



在比特币系统中，锁定脚本与解锁脚本随着堆栈的传递被分别执行，验证着每一笔交易的过程。

<img title="" src=".\\picture\\P2PKH2.png" alt="P2PKH" style="zoom:25%;" data-align="center">

### 特点

**基于堆栈执行.** 比特币交易脚本系统是一种基于逆波兰表示法的基于堆栈的执行语言。脚本是一种功能简单的编程语言，被设计成在有限的硬件上执行。

脚本是基于堆栈的编程语言,  数据结构栈只允许两种操作，入栈和出栈。入栈是在栈顶添加元素,而出栈是将栈顶的元素移出栈.

交易系统从左到右依次执行脚本中操作, 每个操作使用堆栈执行. 

<img title="" src=".//picture//stack.jpg" alt="栈" data-align="inline" style="zoom:67%;">

**不具备图灵完备性.**

图灵完备性要求系统拥有的一系列数据操作规则能够模仿任何图灵机 , 则这种系统图灵完备.[2] 

具有图灵完备性则意味着系统能够解决所有的可计算问题.

比特币脚本系统中不存在for、while循环等复杂指令流,  限制了脚本语言的执行次数和复杂度, 确保了比特币系统的安全性和稳定性.

**去中心化**

比特币系统在理论上对所有人或机构一视同仁, 任意参与方的脚本执行效果相同. 

因此脚本的验证可以在任何参与方的系统中验证, 一个有效的交易对所有人都有效.





## 实际测试

在比特币测试网络上运行脚本.

```matlab
%锁定脚本


%解锁脚本



```









## 参考文献

[1] [脚本语言 - 维基百科，自由的百科全书 (wikipedia.org)](https://zh.wikipedia.org/wiki/%E8%84%9A%E6%9C%AC%E8%AF%AD%E8%A8%80)

[2] Turing, A. M. Proceedings of the London Mathematical Society. 2. 1936, **42**: 230–265 [2020-07-04]. [doi:10.1112/plms/s2-42.1.230].
