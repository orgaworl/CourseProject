### Birthday Attack Of SM3 Hash Function

#### Birthday attack

随机产生t个不同的消息, 分别计算其对应的Hash值, 若找到两个Hash值相同的消息,则找到一组碰撞.  
实质为穷举可能结果的暴力破解.  
成功概率超过$\frac{1}{2}$的时间复杂度为$O(2^{\frac{n}{2}})$, 其中n为散列值的二进制长度.

为了抵抗生日攻击，通常建议消息摘要的长度至少应取为128比特，此时生日攻击需要约$2^{64}$次Hash.   SM3 的Hash值为256比特, 基本可以抵抗生日攻击.

### Reduced SM3

为了令针对SM3的生日攻击在计算上可行, 我们需要缩短SM3输出Hash值的bit长度.   
本文选择将原本256bit长的Hash值划分为 $\frac{256}{k}$ 组 $k\ bit$ 长值, 相互之间进行异或, 得到 k bit的Hash值.



### Birthday Attack of Reduced SM3

**测试平台**  

| 配置       | 参数                                |
| -------- | --------------------------------- |
| CPU      | INTEL CORE i5-11300H 3.1GHz 4核8线程 |
| Memory   | DDR4 3200Hz 16GB                  |
| OS       | Windows10                         |
| IDE      | VS2019                            |
| Language | C++                               |



**测试结果**  
原SM3的Hash结果如下:

| 变量        | 值                                                                |
| --------- | ---------------------------------------------------------------- |
| 明文字符串     | "202100460116"                                                   |
| 对应字节码     | 32 30 32 31 30 30 34 36 30 31 31 36                              |
| SM4 Hash值 | eb4f59408de88026ef447a89b7cfce4311ba69a5ee4a220be6c310aee576dd51 |



设定reduced SM3 Hash值长度为k, 计算缩短 Hash值, 寻找对应碰撞消息.    
找到碰撞如下:

| 长度(bit) | reduced Hash Value | Collision                                      |
| ------- | ------------------ | ---------------------------------------------- |
| 8       | 6d                 | 38e51b34683e9772e27b214a304dbd89               |
| 16      | 1ea5               | 5768f777238a43bc11c4c2f48c2a4b66               |
| 32      | c269ebfd           | addfe95c010c2a7f233e09c2fc0cd30d64403526928052 |

Hash值长度超过64bit时难以找到一个碰撞.
